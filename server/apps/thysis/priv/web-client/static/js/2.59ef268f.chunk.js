(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{342:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"b",function(){return o});var a=function(e){return[e.lastName,e.firstName,e.middleName].filter(function(e){return!!e}).join(" ")},n=function(e){if(!e)return"";var t="";return e.firstName&&(t+=e.firstName.charAt(0)),e.middleName&&e.middleName.split(" ").forEach(function(e){return t+=e.charAt(0)}),t?e.lastName+" "+t:e.lastName},o=function(e){var t=e.authors.map(n).join(", ");return e.year&&(t+=" (".concat(e.year,")")),t+=", "+e.topic,e.publication&&(t+=", "+e.publication),e.url&&(t+=" , "+e.url),t+=" | "+e.sourceType.name}},345:function(e,t,r){"use strict";r.d(t,"b",function(){return a}),r.d(t,"a",function(){return n}),r.d(t,"d",function(){return o}),r.d(t,"c",function(){return c});var a="#9f3a38",n="#fff6f6",o="#2c662d",c="#f8f8f9"},348:function(e,t,r){"use strict";var a=r(23),n=r(612),o=r(64),c=r(68),s=r(66),i=r(65),u=r(67),l=r(0),d=r(400),m=r(633),p=(r(358),{showingSidebar:!1}),f=r(40),h=r(12),b=function(e){function t(){var e,r;Object(o.a)(this,t);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return(r=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(n)))).state=p,r.renderWithContext=function(e){var t=r.props,a=t.className,n=void 0===a?"":a,o=t.style,c=t.currentProject,s=t.title,i=t.match.path,u=t.showSideBarTrigger,p=e.onShowClicked,f=e.minWidth600,b=e.showSidebar,E=!f||!b;return l.createElement("div",{className:"".concat(n," src-components-header"),style:o},l.createElement("div",{className:"top"},u&&E&&l.createElement("a",{className:"sidebar-trigger item",onClick:p},l.createElement(d.a,{name:"content"})),l.createElement("div",{className:"title"},s)),c&&l.createElement("div",{className:"bottom"},i===h.e?l.createElement("span",{className:"project-title"},c.title):l.createElement(m.a,{to:Object(h.k)(),className:"project-title"},c.title)))},r}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return l.createElement(f.a,null,this.renderWithContext)}}]),t}(l.Component),E=r(118),v=Object(a.e)(E.a,{props:function(e){return e.data}});t.a=Object(a.d)(n.a,v)(b)},354:function(e,t,r){"use strict";var a=r(443),n=r(23),o=r(52),c=r(64),s=r(68),i=r(66),u=r(65),l=r(67),d=r(0),m=r.n(d),p=r(632),f=r(602),h=r(601),b=r(400),E=r(633),v=r(117),g=r.n(v),S=(r(484),{modalState:{newTag:!1,newSource:!1,tagList:!1}}),O=r(40),j=r(12),C=r(37),y=r(27),k=r(10),T=r.n(k),N=r(15),w=r(616),F=r(629),A=r(618),x=r(613),M=r(631),I=r(624),R=r(7),_=r(8),W=r.n(_),B=r(83);function U(){var e=Object(R.a)(["\n  mutation CreateTag($tag: CreateTagInput!) {\n    createTag(tag: $tag) {\n      ...TagFrag\n    }\n  }\n\n  ","\n"]);return U=function(){return e},e}var L=W()(U(),B.a),$=r(122),P={text:"",formError:void 0,submitting:!1,submitSuccess:!1},Q=function(e){function t(){var e,r;Object(c.a)(this,t);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return(r=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state=P,r.renderErrorOrSuccess=function(){var e=r.state,t=e.formError,a=e.submitSuccess;return t?m.a.createElement(I.a,{icon:!0,error:!0},m.a.createElement(b.a,{name:"ban"}),m.a.createElement(I.a.Content,null,m.a.createElement(I.a.Header,null,"An error has occurred"),t.message)):a?m.a.createElement(I.a,{error:!0,success:!0,content:"Tag created successfully!"}):void 0},r.reset=Object(N.a)(T.a.mark(function e(){return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.props.dismissModal();case 1:case"end":return e.stop()}},e)})),r.handleFocus=function(){return r.setState({formError:void 0,submitSuccess:!1})},r.handleChange=function(e){return function(t){var a=t.target;r.setState(function(t){return g()(t,Object(o.a)({},e,{$set:a.value}))})}},r.handleSubmit=function(e){return Object(N.a)(T.a.mark(function t(){return T.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r.setState({submitting:!0}),t.next=4,e();case 4:r.setState({submitSuccess:!0,submitting:!1}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),r.setState({formError:t.t0,submitting:!1});case 10:case"end":return t.stop()}},t,null,[[0,7]])}))},r.writeTagsToCache=function(){var e=Object(N.a)(T.a.mark(function e(t,a){var n,o,c,s;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.data){e.next=3;break}return e.abrupt("return");case 3:if(o=n.createTag,!r.props.onTagCreated){e.next=8;break}r.props.onTagCreated(o),e.next=9;break;case 8:return e.abrupt("return");case 9:c={query:$.a},e.prev=10,s=t.readQuery(c),t.writeQuery(Object(y.a)({},c,{data:g()(s,{tags:{$push:[o]}})})),e.next=20;break;case 15:if(e.prev=15,e.t0=e.catch(10),!e.t0.message.startsWith("Can't find field tags on object")){e.next=19;break}return e.abrupt("return");case 19:throw e.t0;case 20:case"end":return e.stop()}},e,null,[[10,15]])}));return function(t,r){return e.apply(this,arguments)}}(),r}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,r=t.open,a=t.style,o=this.state,c=o.text,s=o.question,i=o.formError,u=o.submitting,l=o.submitSuccess;return m.a.createElement(A.a,{style:Object(y.a)({},a||{},{background:"#fff"}),basic:!0,size:"small",dimmer:"inverted",open:r,onClose:this.reset},m.a.createElement(M.a,{icon:"quote left",content:"Subject matter of quote"}),m.a.createElement(A.a.Content,null,this.renderErrorOrSuccess(),m.a.createElement(w.a,null,m.a.createElement(w.a.Field,{control:x.a,name:"tag",placeholder:"Tag text",label:"Tag text",fluid:!0,onChange:this.handleChange("text"),onFocus:this.handleFocus,error:!!i}),m.a.createElement(w.a.Field,{control:x.a,name:"question",placeholder:"Question",label:"Question",fluid:!0,onChange:this.handleChange("question"),onFocus:this.handleFocus,error:!!i})),m.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"20px"}},m.a.createElement(F.a,{id:"tag-modal-close",basic:!0,color:"red",onClick:this.reset,disabled:u},m.a.createElement(b.a,{name:"remove"})," Dismiss"),m.a.createElement(n.b,{mutation:L,variables:{tag:{text:c,question:s}},update:this.writeTagsToCache},function(t){return m.a.createElement(F.a,{id:"tag-modal-submit",color:"green",inverted:!0,disabled:!!i||c.length<2||u||l,onClick:e.handleSubmit(t),loading:u},m.a.createElement(b.a,{name:"checkmark"})," Ok")}))))}}]),t}(m.a.Component),q=r(438),D=r(612),H=r(332),G=r(619),z=(r(579),r(365)),V=function(e){function t(){var e,r;Object(c.a)(this,t);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(r=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).renderTags=function(e){var t=e.loading,a=e.data,n=e.error;if(n)return m.a.createElement("div",{className:"error-container",onClick:r.props.dismissModal},n.message);if(t)return m.a.createElement(H.a,{active:!0});var o=a?a.tags:null;return o&&o.length?m.a.createElement(G.a,{divided:!0,relaxed:!0},o.map(r.renderTag)):m.a.createElement(I.a,{className:"no-resources-message"},m.a.createElement(I.a.Content,null,'No tags for "current project"'))},r.renderTag=function(e){if(e){var t=e.id,a=e.text,n=e.question;return m.a.createElement(G.a.Item,{key:t,id:t,onClick:r.navigateTo(t)},m.a.createElement(G.a.Content,null,m.a.createElement("div",null,a),n&&m.a.createElement("div",{style:{paddingLeft:"10%",fontStyle:"italic"}},n)))}},r.resetModal=function(){r.props.dismissModal()},r.navigateTo=function(e){return function(){r.resetModal(),r.props.history.push(Object(j.n)(e))}},r}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.open;return m.a.createElement(z.d,{query:$.a},function(r){return m.a.createElement(A.a,{className:"src-components-tags-modal",basic:!0,dimmer:"inverted",open:t,onClose:e.resetModal},m.a.createElement(A.a.Content,null,m.a.createElement("div",{id:"tag-list-modal-close",className:"modal-close",onClick:e.props.dismissModal},"\xd7"),e.renderTags(r)))})}}]),t}(m.a.Component),Y=Object(D.a)(V),K=(r(580),r(342)),J=function(e){function t(){var e,r;Object(c.a)(this,t);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(r=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).renderSources=function(){var e=r.props,t=e.error,a=e.dismissModal;if(t)return m.a.createElement("div",{className:"error-container",onClick:a},t.message);if(r.props.loading)return m.a.createElement(H.a,{active:!0});var n=r.props,o=n.sources,c=n.currentProject;return o&&o.length?m.a.createElement(G.a,{divided:!0,relaxed:!0},o.map(r.renderSource)):m.a.createElement(I.a,{className:"no-resources-message"},m.a.createElement(I.a.Content,null,"No sources for ",' "'.concat(c&&c.title,'"')))},r.renderSource=function(e){if(e)return m.a.createElement(G.a.Item,{key:e.id,className:"list-item",onClick:r.navigateTo(e.id)},m.a.createElement(G.a.Content,null,Object(K.b)(e)))},r.resetModal=function(){r.props.dismissModal()},r.navigateTo=function(e){return function(){r.resetModal(),r.props.history.push(Object(j.m)(e))}},r}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return m.a.createElement(A.a,{id:"sources-modal",basic:!0,open:this.props.open,onClose:this.resetModal,dimmer:"inverted",className:"src-components-sources-modal"},m.a.createElement(A.a.Content,null,m.a.createElement("div",{id:"sources-modal-close",className:"modal-close",onClick:this.props.dismissModal},"\xd7"),this.renderSources()))}}]),t}(m.a.Component),X=r(123),Z=r(118),ee=function(e){return e?Object(y.a)({},e,{display:"".concat(Object(K.b)(e)," | ").concat(e.sourceType.name)}):{}},te=function(e){return e?e.map(ee):[]},re=Object(n.e)(X.a,{props:function(e){var t=e.data;if(!t||!t.sources)return t;var r=t.sources;return Object(y.a)({},t,{sources:te(r)})},options:function(e){var t=e.currentProject;return{variables:{source:{projectId:t&&t.id||"0"}}}}}),ae=Object(n.e)(Z.a,{props:function(e){return e.data}}),ne=Object(n.d)(D.a,ae,re)(J),oe=r(437),ce=r(124),se=r(343),ie=r(184),ue=r.n(ie),le={initialFormValues:{name:""},graphQlError:void 0,submitting:!1,submitSuccess:!1},de=function(e){function t(){var e,r;Object(c.a)(this,t);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(r=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state=le,r.validate=function(e){for(var t={},a=Object.keys(e),n=0;n<a.length;n++){var o=a[n],c=r["validate".concat(o.charAt(0).toUpperCase()).concat(o.slice(1))](e[o].trim());if(c)return t[o]=c,t}return t},r.validateName=function(e){return e?e.length<2?"Too short":"":"Enter source name"},r.renderErrorOrSuccess=function(){var e=r.state,t=e.graphQlError,a=e.submitSuccess;return t?m.a.createElement(I.a,{icon:!0,error:!0},m.a.createElement(b.a,{name:"ban"}),m.a.createElement(I.a.Content,null,m.a.createElement(I.a.Header,null,"An error has occurred"),t.message)):a?m.a.createElement(I.a,{error:!0,success:!0,content:"Source created successfully!"}):void 0},r.onResetClicked=function(e){return function(){e(),r.props.dismissModal()}},r.submit=function(){var e=Object(N.a)(T.a.mark(function e(t,a){return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setSubmitting(!0),e.prev=1,e.next=4,r.props.createSourceType&&r.props.createSourceType(t.name.trim());case 4:r.setState({submitSuccess:!0}),a.resetForm(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),a.setSubmitting(!1),r.setState({graphQlError:e.t0});case 12:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),r.renderForm=function(e){var t=e.handleReset,a=e.dirty,n=e.isSubmitting,o=e.errors,c=e.handleSubmit,s=!a||n||!ue()(o);return m.a.createElement(w.a,{onSubmit:c},[["Source Name","name"]].map(function(e){var t=Object(ce.a)(e,2),a=t[0],n=t[1];return m.a.createElement(se.a,{key:n,name:n,render:r.renderInput(a)})}),m.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"20px"}},m.a.createElement(F.a,{id:"source-type-modal-close",basic:!0,color:"red",onClick:r.onResetClicked(t),disabled:n,type:"button"},m.a.createElement(b.a,{name:"remove"})," Dismiss"),m.a.createElement(F.a,{id:"source-type-modal-submit",color:"green",inverted:!0,disabled:s,loading:n,type:"submit"},m.a.createElement(b.a,{name:"checkmark"})," Ok")))},r.renderInput=function(e){return function(t){var a=t.field,n=t.form,o=a.name,c=n.errors[o],s=!!c,i=n.touched[o];return m.a.createElement("div",null,m.a.createElement(w.a.Field,Object.assign({control:x.a,placeholder:e,autoComplete:"off",label:e,id:o,error:s,onBlur:r.handleFormControlBlur(o,n),onFocus:r.handleFocus},a)),s&&i&&m.a.createElement(I.a,{style:{display:"block",padding:"0.5em",marginBottom:"1em",marginTop:"-10px"},error:!0,header:c}))}},r.handleFormControlBlur=function(e,t){return function(){t.setFieldTouched(e,!0)}},r.handleFocus=function(){r.setState({graphQlError:void 0,submitSuccess:!1})},r}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.open,r=e.style;return m.a.createElement(A.a,{style:Object(y.a)({},r||{},{background:"#fff"}),basic:!0,size:"small",dimmer:"inverted",open:t,onClose:this.onResetClicked(function(){return null})},m.a.createElement(M.a,{icon:"user",content:"Source Type Details"}),m.a.createElement(A.a.Content,null,this.renderErrorOrSuccess(),m.a.createElement(se.b,{initialValues:this.state.initialFormValues,enableReinitialize:!0,onSubmit:this.submit,render:this.renderForm,validate:this.validate})))}}]),t}(m.a.Component),me=r(46);function pe(){var e=Object(R.a)(["\n  mutation CreateSourceType($sourceType: CreateSourceTypeInput!) {\n    sourceType(sourceType: $sourceType) {\n      ...SourceTypeFrag\n    }\n  }\n\n  ","\n"]);return pe=function(){return e},e}var fe=W()(pe(),me.b),he=r(139),be=r(74),Ee=Object(n.e)(be.a,{props:function(e){return e.data}}),ve=Object(n.e)(fe,{props:function(e){var t=e.mutate;if(e.ownProps.user)return{createSourceType:function(e){return t({variables:{sourceType:{name:e}},update:function(e,t){var r=t.data;if(r){var a=r.sourceType;if(!a){var n=e.readQuery({query:he.a}),o=g()(n,{sourceTypes:{$push:[a]}});e.writeQuery({query:he.a,data:o})}}}})}}}}),ge=Object(n.d)(Ee,ve)(de),Se=[j.b,j.i],Oe=function(e){function t(){var e,r;Object(c.a)(this,t);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return(r=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state=S,r.context=void 0,r.renderSideBar=function(e){r.context=e;var t=e.onShowClicked,a=e.minWidth600,n="src-components-app-sidebar";a&&(n+=" pushable-min-width-600"),e.showSidebar&&(n+=" pushable-showing-sidebar");var o=r.props,c=o.match.path,s=o.currentProject;return d.createElement(p.a.Pushable,{as:f.a,className:n},d.createElement(p.a,{as:h.a,animation:"overlay",icon:"labeled",onHide:r.hideSidebar,vertical:!0,visible:e.showSidebar},a&&d.createElement("a",{className:"sidebar-trigger-sidebar item",onClick:t},d.createElement(b.a,{name:"content"})),s&&c!==j.e?d.createElement(h.a.Item,{as:E.a,to:Object(j.k)(),onClick:r.hideSidebar,className:"home-menu"},d.createElement(b.a,{name:"quote right"}),d.createElement("span",null,"Home")):void 0,c!==j.c?d.createElement(h.a.Item,{as:E.a,to:j.c,onClick:r.hideSidebar},d.createElement(b.a,{name:"gem"}),d.createElement("span",null,"Projects")):void 0,s&&c!==j.f?d.createElement(h.a.Item,{as:E.a,to:j.f,onClick:r.hideSidebar},d.createElement(b.a,{name:"search"}),d.createElement("span",null,"Search")):void 0,s&&d.createElement(h.a.Item,{onClick:r.toggleModalState(C.b.NEW_SOURCE,!0)},d.createElement(b.a,{name:"user"}),d.createElement("span",null,"New Source")),s&&d.createElement(h.a.Item,{onClick:r.toggleModalState(C.b.NEW_AUTHOR,!0)},d.createElement(b.a,{name:"user"}),d.createElement("span",null,"New Author")),s&&d.createElement(h.a.Item,{onClick:r.toggleModalState(C.b.NEW_TAG,!0)},d.createElement(b.a,{name:"tag"}),d.createElement("span",null,"New Tag")),s&&d.createElement(h.a.Item,{onClick:r.toggleModalState(C.b.NEW_SOURCE_TYPE,!0)},d.createElement(b.a,{name:"tree"}),d.createElement("span",null,"New Source Type")),s&&d.createElement(h.a.Item,{onClick:r.toggleModalState(C.b.TAG_LIST,!0)},d.createElement(b.a,{name:"numbered list"}),d.createElement("span",null,"List Tags")),s&&d.createElement(h.a.Item,{onClick:r.toggleModalState(C.b.SOURCE_LIST,!0)},d.createElement(b.a,{name:"numbered list"}),d.createElement("span",null,"List Sources")),Se.includes(c)?void 0:d.createElement(h.a.Item,{onClick:r.logout(r.hideSidebar)},d.createElement(b.a,{name:"sign-out"}),d.createElement("span",null,"Logout"))),d.createElement(p.a.Pusher,{style:{height:"100%"}},r.props.children),r.state.modalState[C.b.NEW_TAG]&&d.createElement(Q,{open:r.state.modalState[C.b.NEW_TAG],dismissModal:r.toggleModalState(C.b.NEW_TAG,!1),style:{marginTop:0},onTagCreated:r.props.onTagCreated}),r.state.modalState[C.b.NEW_SOURCE]&&d.createElement(q.a,{open:r.state.modalState[C.b.NEW_SOURCE],dismissModal:r.toggleModalState(C.b.NEW_SOURCE,!1),style:{marginTop:0}}),r.state.modalState[C.b.NEW_SOURCE_TYPE]&&d.createElement(ge,{open:r.state.modalState[C.b.NEW_SOURCE_TYPE],dismissModal:r.toggleModalState(C.b.NEW_SOURCE_TYPE,!1),style:{marginTop:0}}),r.state.modalState[C.b.SOURCE_LIST]&&d.createElement(ne,{open:r.state.modalState[C.b.SOURCE_LIST],dismissModal:r.toggleModalState(C.b.SOURCE_LIST,!1)}),r.state.modalState[C.b.TAG_LIST]&&d.createElement(Y,{open:r.state.modalState[C.b.TAG_LIST],dismissModal:r.toggleModalState(C.b.TAG_LIST,!1)}),r.state.modalState[C.b.NEW_AUTHOR]&&d.createElement(oe.a,{open:r.state.modalState[C.b.NEW_AUTHOR],modal:!0,dismissModal:r.toggleModalState(C.b.NEW_AUTHOR,!1)}))},r.logout=function(e){return function(){e(),r.props.history.replace(j.b)}},r.toggleModalState=function(e,t){return function(){t&&r.context&&r.hideSidebar(),r.setState(function(e){return g()(e,{modalState:{$set:S.modalState}})}),r.setState(function(r){return g()(r,{modalState:Object(o.a)({},e,{$set:t})})})}},r.hideSidebar=function(){if(r.context){var e=r.context,t=e.minWidth600,a=e.onHide;if(t)return;a()}},r}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return d.createElement(O.a,null,this.renderSideBar)}}]),t}(d.Component),je=r(131),Ce=Object(n.e)(Z.a,{props:function(e){return e.data}});t.a=Object(n.d)(a.a,je.a,Ce)(Oe)},358:function(e,t,r){},365:function(e,t,r){"use strict";r.d(t,"d",function(){return i}),r.d(t,"a",function(){return u}),r.d(t,"b",function(){return l}),r.d(t,"c",function(){return d});var a=r(64),n=r(66),o=r(65),c=r(67),s=r(23),i=function(e){function t(){return Object(a.a)(this,t),Object(n.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),t}(s.c),u=function(e){function t(){return Object(a.a)(this,t),Object(n.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),t}(s.c),l=(s.c,function(e){function t(){return Object(a.a)(this,t),Object(n.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),t}(s.c)),d=function(e){function t(){return Object(a.a)(this,t),Object(n.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),t}(s.c);s.c},437:function(e,t,r){"use strict";var a,n,o=r(10),c=r.n(o),s=r(15),i=r(27),u=r(23),l=r(117),d=r.n(l),m=r(124),p=r(64),f=r(68),h=r(66),b=r(65),E=r(67),v=r(0),g=r.n(v),S=r(629),O=r(618),j=r(613),C=r(631),y=r(624),k=r(400),T=r(616),N=r(343),w=r(184),F=r.n(w),A=(r(581),r(52));!function(e){e.LAST_NAME="lastName",e.FIRST_NAME="firstName",e.MIDDLE_NAMES="middleName"}(n||(n={}));var x={initialFormOutput:(a={},Object(A.a)(a,n.LAST_NAME,""),Object(A.a)(a,n.FIRST_NAME,""),Object(A.a)(a,n.MIDDLE_NAMES,""),a),graphQlError:void 0,submitting:!1,createdAuthors:[]},M=r(342),I=r(438),R=function(e){function t(e){var r;Object(p.a)(this,t),(r=Object(h.a)(this,Object(b.a)(t).call(this,e))).contentRef=g.a.createRef(),r.renderContent=function(){return g.a.createElement("div",null,r.renderError(),g.a.createElement(N.b,{initialValues:r.state.initialFormOutput,enableReinitialize:!0,onSubmit:r.submit,render:r.renderForm,validate:r.validate}))},r.validate=function(e){for(var t={},a=Object.keys(e),n=0;n<a.length;n++){var o=a[n],c=r["validate".concat(o.charAt(0).toUpperCase()).concat(o.slice(1))](e[o]);if(c)return t[o]=c,t}return t},r.validateLastName=function(e){return e?e.length<2?"Too short":"":"Enter last name"},r.validateFirstName=function(e){return""},r.validateMiddleName=function(e){return""},r.renderError=function(){var e=r.state.graphQlError;if(e)return g.a.createElement(y.a,{icon:!0,error:!0},g.a.createElement(k.a,{name:"ban"}),g.a.createElement(y.a.Content,null,g.a.createElement(y.a.Header,null,"An error has occurred"),e.message))},r.onResetClicked=function(e){return function(){e(),r.props.dismissModal()}},r.submit=function(){var e=Object(s.a)(c.a.mark(function e(t,a){var n,o,s,i,u,l,d,m;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.setSubmitting(!0),n=r.state.author,o=r.props,s=o.onAuthorCreated,i=o.createAuthor,u=o.authorUpdate,e.prev=3,n){e.next=12;break}return e.next=7,i&&i(r.eliminateEmptyFields(t));case 7:(l=e.sent)&&l.data&&l.data.createAuthor&&(d=l.data.createAuthor,s?s(d):r.handleAuthorCreated(d)),a.resetForm(),e.next=19;break;case 12:return e.next=14,u&&u(n.id,r.prepFormForUpdate(t));case 14:if(!((m=e.sent)&&m.data&&m.data.updateAuthor)){e.next=19;break}return s&&s(m.data.updateAuthor),r.props.dismissModal(),e.abrupt("return");case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(3),a.setSubmitting(!1),r.setState({graphQlError:e.t0});case 25:case"end":return e.stop()}},e,null,[[3,21]])}));return function(t,r){return e.apply(this,arguments)}}(),r.renderForm=function(e){var t=e.handleReset,a=e.dirty,o=e.isSubmitting,c=e.errors,s=e.handleSubmit,i=!a||o,u=i||!F()(c);return g.a.createElement("div",null,g.a.createElement(T.a,{onSubmit:s},[["Last Name",n.LAST_NAME],["First Name",n.FIRST_NAME],["Middle Names",n.MIDDLE_NAMES]].map(function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return g.a.createElement(N.a,{key:n,name:n,render:r.renderInput(a)})}),g.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"20px"}},g.a.createElement(S.a,{id:"author-modal-close",basic:!0,color:"red",onClick:r.onResetClicked(t),disabled:o,type:"button"},g.a.createElement(k.a,{name:"remove"})," Dismiss"),g.a.createElement(S.a,{id:"author-modal-reset",color:"olive",basic:!0,disabled:i,onClick:t,type:"button"},g.a.createElement(k.a,{name:"repeat"})," Reset"),g.a.createElement(S.a,{id:"author-modal-submit",color:"green",inverted:!0,disabled:u,loading:o,type:"submit"},g.a.createElement(k.a,{name:"checkmark"})," Ok"))))},r.renderInput=function(e){return function(t){var a=t.field,n=t.form,o=a.name,c=n.errors[o],s=!!c,i=n.touched[o];return g.a.createElement("div",null,g.a.createElement(T.a.Field,Object.assign({control:j.a,placeholder:e,autoComplete:"off",label:e,id:o,error:s,onBlur:r.handleFormControlBlur(o,n),onFocus:r.handleFocus},a)),s&&i&&g.a.createElement(y.a,{style:{display:"block",padding:"0.5em",marginBottom:"1em",marginTop:"-10px"},error:!0,header:c}))}},r.handleFormControlBlur=function(e,t){return function(){t.setFieldTouched(e,!0)}},r.handleFocus=function(){r.setState({graphQlError:void 0})},r.eliminateEmptyFields=function(e){for(var t={},r=Object.entries(e),a=0;a<r.length;a++){var n=r[a],o=Object(m.a)(n,2),c=o[0],s=o[1];s&&(s=s.trim())&&(t[c]=s)}return t},r.prepFormForUpdate=function(e){for(var t={},r=Object.entries(e),a=0;a<r.length;a++){var n=r[a],o=Object(m.a)(n,2),c=o[0],s=o[1];t[c]=s.trim()||null}return t},r.initStateWithAuthor=function(e){var t={};Object.values(n).forEach(function(r){var a=e[r];t[r]=a||""}),r.state=d()(r.state,{initialFormOutput:{$set:t},author:{$set:e}})},r.renderAuthorCreated=function(){var e=r.state.createdAuthors,t=e.length;if(t)return g.a.createElement(y.a,{success:!0},g.a.createElement(y.a.Header,{className:"authors-display-header"},g.a.createElement("span",{className:"label"},"New author",1===t?"":"s"," (",t,"):"),g.a.createElement(S.a,{compact:!0,className:"go-create-source",onClick:r.showCreateSourceModal},"Create source?")),g.a.createElement("ol",{className:"authors-list"},e.map(r.renderAuthor)))},r.renderAuthor=function(e){return g.a.createElement("li",{key:e.id},Object(M.a)(e))},r.showCreateSourceModal=function(){return r.setState({showSourceModal:!0})},r.handleAuthorCreated=function(e){r.setState(function(t){return d()(t,{createdAuthors:{$push:[e]}})}),r.contentRef.current&&(r.contentRef.current.scrollTop=0)},r.state=d()(x,{open:{$set:e.open}});var a=e.author;return a&&r.initStateWithAuthor(a),r}return Object(E.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,t=e.style,r=e.modal,a=this.state,n=a.open,o=a.showSourceModal,c=a.createdAuthors;return o&&c.length?g.a.createElement(I.a,{open:!0,authors:c}):r?g.a.createElement(O.a,{style:Object(i.a)({},t||{},{background:"#fff"}),className:"src-components-new-author-modal",basic:!0,size:"small",dimmer:"inverted",open:n,onClose:this.onResetClicked(function(){return null})},g.a.createElement("div",{className:"new-author-content",ref:this.contentRef},g.a.createElement(O.a.Content,null,this.renderAuthorCreated(),g.a.createElement(C.a,{icon:"user",content:"Author Details"}),this.renderContent()))):this.renderContent()}}]),t}(g.a.Component),_=r(7),W=r(8),B=r.n(W),U=r(82);function L(){var e=Object(_.a)(["\n  mutation CreateAuthor($author: CreateAuthorInput!) {\n    createAuthor(author: $author) {\n      ...AuthorFrag\n    }\n  }\n\n  ","\n"]);return L=function(){return e},e}var $=B()(L(),U.b),P=r(140),Q=r(74),q=r(118);function D(){var e=Object(_.a)(["\n  mutation AuthorUpdate($author: UpdateAuthorInput!) {\n    updateAuthor(author: $author) {\n      ...AuthorFrag\n    }\n  }\n\n  ","\n"]);return D=function(){return e},e}var H=B()(D(),U.a),G=Object(u.e)($,{props:function(e){var t=e.mutate,r=e.ownProps,a=r.currentProject,n=r.user;if(a&&n){var o=a.id;return{createAuthor:function(e){return t({variables:{author:Object(i.a)({},e,{projectId:o,userId:n.id})},update:function(){var e=Object(s.a)(c.a.mark(function e(t,r){var a,n,s,u,l,m;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.data){e.next=3;break}return e.abrupt("return");case 3:if(n=a.createAuthor){e.next=6;break}return e.abrupt("return");case 6:s={query:P.a,variables:{author:{projectId:o}}},e.prev=7,u=t.readQuery(s),l=d()(u,{authors:{$push:[n]}}),t.writeQuery(Object(i.a)({},s,{data:l})),e.next=19;break;case 13:if(e.prev=13,e.t0=e.catch(7),m='Can\'t find field authors({"author":{"projectId":"'.concat(o,'"}})'),!e.t0.message.startsWith(m)){e.next=18;break}return e.abrupt("return");case 18:throw e.t0;case 19:case"end":return e.stop()}},e,null,[[7,13]])}));return function(t,r){return e.apply(this,arguments)}}()})}}}}}),z=Object(u.e)(Q.a,{props:function(e){return e.data}}),V=Object(u.e)(q.a,{props:function(e){return e.data}}),Y=Object(u.e)(H,{props:function(e){var t=e.mutate;return{authorUpdate:function(e,r){return t({variables:{author:Object(i.a)({id:e},r)}})}}}});t.a=Object(u.d)(V,z,G,Y)(R)},438:function(e,t,r){"use strict";var a=r(27),n=r(612),o=r(23),c=r(343),s=r(117),i=r.n(s),u=r(10),l=r.n(u),d=r(15),m=r(64),p=r(68),f=r(66),h=r(65),b=r(67),E=r(0),v=r.n(E),g=r(616),S=r(629),O=r(400),j=r(631),C=r(624),y=r(613),k=r(618),T=r(620),N=r(184),w=r.n(N),F=r(342),A=r(440),x=r(441),M=r(12),I=r(340),R=r.n(I),_=r(341),W=r.n(_),B=r(345);R.a.setup(W()());var U={modal:{marginTop:0,background:"#fff"},form:{height:"100%",overflowX:"hidden",overflowY:"auto",paddingRight:10},fieldWrapper:{marginBottom:"1em"},formButtonsContainer:{display:"flex",marginBottom:"15px"},submitButton:{margin:"0 15px"},successCard:{backgroundColor:"#fcfff5",boxShadow:"0 0 0 1px #a3c293 inset, 0 0 0 0 transparent",margin:"auto"},errorMessage:{position:"relative",top:-10,color:B.b}},L=U.modal,$=R.a.createStyleSheet(U).attach().classes,P={sourceType:null,authors:[],topic:"",publication:"",url:"",year:""},Q={open:!0},q={handleSubmit:function(){var e=Object(d.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),mapPropsToValues:function(e){var t=(e.authors||[]).map(function(e){return Object(a.a)({},e,{fullName:Object(F.a)(e)})});return Object(a.a)({},P,{authors:t})},enableReinitialize:!0,validate:function(e){var t={};return e.sourceType?e.authors&&e.authors.length?e.topic&&e.topic.trim()||(t.topic="Enter source topic according to author(s)"):t.authors="Select at least one author":t.sourceType="Select a source type",t}},D=function(e){function t(){var e,r;Object(m.a)(this,t);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(r=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(n)))).state=Q,r.submit=Object(d.a)(l.a.mark(function e(){var t,a,n,o,c,s,i,u;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.props,a=t.createSource,n=t.values,o=t.setSubmitting,c=t.resetForm,a){e.next=4;break}return r.setState({formError:{message:"You have not selected a project"}}),e.abrupt("return");case 4:return o(!0),e.prev=5,e.next=8,a(n);case 8:if(s=e.sent,o(!1),c(),s){e.next=13;break}return e.abrupt("return");case 13:if(i=s.data){e.next=16;break}return e.abrupt("return");case 16:u=i.createSource,r.setState({source:u}),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(5),r.setState({formError:e.t0}),o(!1);case 24:case"end":return e.stop()}},e,null,[[5,20]])})),r.renderForm=function(){var e=r.props,t=e.handleReset,a=e.dirty,n=e.isSubmitting,o=e.errors,s=!a||n,i=s||!w()(o);return v.a.createElement(g.a,{className:$.form,onSubmit:r.submit},v.a.createElement(c.a,{name:"sourceType",render:r.renderSourceTypeControl}),v.a.createElement(c.a,{name:"authors",render:r.renderAuthorsControl}),[{name:"topic"},{name:"year"},{name:"publication"},{name:"url"}].map(r.renderTextControl),v.a.createElement("div",{className:$.formButtonsContainer},v.a.createElement(S.a,{id:"source-modal-close",basic:!0,color:"red",onClick:r.resetModal,disabled:n,type:"button"},v.a.createElement(O.a,{name:"remove"})," Dismiss"),v.a.createElement(S.a,{id:"source-modal-submit",style:U.submitButton,color:"green",disabled:i,loading:n},v.a.createElement(O.a,{name:"checkmark"})," Ok"),v.a.createElement(S.a,{basic:!0,color:"red",onClick:t,disabled:s},v.a.createElement(O.a,{name:"remove"})," Reset")))},r.resetModal=Object(d.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.setState(Q);case 2:r.dismissModal();case 3:case"end":return e.stop()}},e)})),r.renderErrorOrSuccess=function(){var e=r.state,t=e.formError,a=e.source;return t?v.a.createElement(C.a,{icon:!0,error:!0},v.a.createElement(O.a,{name:"ban"}),v.a.createElement(C.a.Content,null,v.a.createElement(C.a.Header,null,"An error has occurred"),t.message)):a?v.a.createElement(T.a,{style:U.successCard},v.a.createElement(T.a.Content,null,v.a.createElement(T.a.Header,{style:{color:"#a3c293"}},"Success"),v.a.createElement(T.a.Description,null,Object(F.b)(a)),v.a.createElement(T.a.Content,{extra:!0},v.a.createElement("div",{className:"ui two buttons"},v.a.createElement(S.a,{basic:!0,color:"green",onClick:r.goToSource(a.id)},"Go to source"),v.a.createElement(S.a,{basic:!0,color:"red",onClick:r.resetModal},"Dismiss"))))):void 0},r.handleFocus=function(){return r.setState({formError:void 0,source:void 0})},r.renderSourceTypeControl=function(e){var t=e.field,a=t.name,n=t.value,o=e.form,c=o.errors[a],s=!!c,i=o.touched[a];return v.a.createElement("div",{className:$.fieldWrapper},v.a.createElement(g.a.Field,{control:A.a,label:"Select source type",error:s,selectError:s,name:a,value:n,onFocus:r.handleFocus,handleBlur:r.handleFormControlBlur(a,o),handleChange:r.handleControlChange(a,o)}),r.renderFieldError(s&&i,c))},r.renderAuthorsControl=function(e){var t=e.field,a=t.name,n=t.value,o=e.form,c=o.errors[a],s=!!c,i=o.touched[a];return v.a.createElement("div",{className:$.fieldWrapper},v.a.createElement(g.a.Field,{control:x.a,label:"Select authors",error:s,selectError:s,onFocus:r.handleFocus,name:a,value:n,handleBlur:r.handleFormControlBlur(a,o),handleChange:r.handleControlChange(a,o)}),r.renderFieldError(s&&i,c))},r.renderTextControl=function(e){var t=e.name,a=e.label;return a=a||t.charAt(0).toUpperCase()+t.slice(1),v.a.createElement(c.a,{key:t,name:t,render:r.renderTextControlFormik(a)})},r.renderTextControlFormik=function(e){return function(t){var a=t.field,n=t.form,o=a.name,c=n.errors[o],s=!!c,i=n.touched[o];return v.a.createElement("div",{className:$.fieldWrapper},v.a.createElement(g.a.Field,Object.assign({control:y.a,placeholder:e,label:e,id:o,error:s,autoComplete:"off",onFocus:r.handleFocus},a)),r.renderFieldError(s&&i,c))}},r.renderFieldError=function(e,t){return e?v.a.createElement("div",{className:$.errorMessage}," ",t," "):void 0},r.handleFormControlBlur=function(e,t){return function(){t.setFieldTouched(e,!0)}},r.handleControlChange=function(e,t){return function(r){return t.setFieldValue(e,r)}},r.goToSource=function(e){return Object(d.a)(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.setState(Q);case 2:r.dismissModal(),r.props.history.push(Object(M.m)(e));case 4:case"end":return t.stop()}},t)}))},r.dismissModal=function(){var e=r.props.dismissModal;e?e():r.setState({open:!1})},r}return Object(b.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.open,r=e.style,n=e.dismissModal?t:this.state.open;return v.a.createElement(k.a,{style:Object(a.a)({},r||{},L),basic:!0,size:"small",dimmer:"inverted",open:n,onClose:this.resetModal},this.renderErrorOrSuccess(),v.a.createElement(j.a,{icon:"user",content:"Create quote source"}),v.a.createElement(k.a.Content,null,this.renderForm()))}}]),t}(v.a.Component),H=r(7),G=r(8),z=r.n(G),V=r(72);function Y(){var e=Object(H.a)(["\n  mutation CreateSource($source: CreateSourceInput!) {\n    createSource(source: $source) {\n      ...SourceFullFrag\n    }\n  }\n  ","\n"]);return Y=function(){return e},e}var K=z()(Y(),V.b),J=r(123),X=r(118),Z=Object(o.e)(X.a,{props:function(e){return e.data}}),ee=Object(o.e)(K,{props:function(e){var t=e.mutate;if(t){var r=e.ownProps.currentProject;if(r){var n=r.id;return{createSource:function(e){var r={source:{sourceTypeId:e.sourceType&&e.sourceType.id||"0",authorIds:e.authors.map(function(e){return e.id}),topic:e.topic.trim(),publication:e.publication.trim()||null,url:e.url.trim()||null,year:e.year.trim()||null,projectId:n}};return t({variables:r,update:function(e,t){var r=t.data;if(r){var o=r.createSource;if(o){var c={query:J.a,variables:{source:{projectId:n}}};try{var s=e.readQuery(c),u=i()(s,{sources:{$push:[o]}});e.writeQuery(Object(a.a)({},c,{data:u}))}catch(l){if(!l.message.startsWith('Can\'t find field sources({"source":{"projectId":"'.concat(n,'"}})')))throw l}}}}})}}}}}});t.a=Object(o.d)(Z,n.a,ee,Object(c.c)(q))(D)},440:function(e,t,r){"use strict";var a=r(64),n=r(68),o=r(66),c=r(65),s=r(67),i=r(375),u=r(0),l=r.n(u),d=r(365),m=r(139),p=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(n.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,r=e.value,a=e.selectError,n=e.handleChange,o=e.handleBlur;return l.a.createElement(d.b,{query:m.a},function(e){var c=e.data,s=[];return c&&(s=c.sourceTypes),l.a.createElement(i.a,{className:"".concat(a?"error":""),id:t,name:t,placeholder:"Select source type",options:s,onChange:n,onBlur:o,value:r,labelKey:"name",valueKey:"id"})})}}]),t}(l.a.Component);t.a=p},441:function(e,t,r){"use strict";var a=r(23),n=r(118),o=r(27),c=r(64),s=r(68),i=r(66),u=r(65),l=r(67),d=r(375),m=r(0),p=r.n(m),f=r(365),h=r(140),b=r(342),E=r(58),v=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,r=e.value,a=e.selectError,n=e.handleChange,c=e.handleBlur,s=e.loading,i=e.currentProject;return s||!i?p.a.createElement(E.a,null):p.a.createElement(f.a,{query:h.a,variables:{author:{projectId:i.id}}},function(e){var s=e.data,i=(s&&s.authors||[]).reduce(function(e,t){return t&&e.push(Object(o.a)({},t,{fullName:Object(b.a)(t)})),e},[]);return p.a.createElement(d.a,{className:"".concat(a?"error":""),id:t,name:t,placeholder:"Select authors",options:i,multi:!0,autoBlur:!0,onChange:n,onBlur:c,value:r,labelKey:"fullName",valueKey:"id"})})}}]),t}(p.a.Component),g=Object(a.e)(n.a,{props:function(e){return e.data}});t.a=g(v)},484:function(e,t,r){},579:function(e,t,r){},580:function(e,t,r){},581:function(e,t,r){}}]);
//# sourceMappingURL=2.59ef268f.chunk.js.map