(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{355:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var n=r(7),a=r(8);function o(){var e=Object(n.a)(["\n  fragment QuoteFromTagFrag on Quote {\n    id\n    text\n    date\n    source {\n      id\n      display\n    }\n  }\n"]);return o=function(){return e},e}var s=r.n(a)()(o())},376:function(e,t,r){"use strict";var n=r(7),a=r(8),o=r.n(a),s=r(355);function c(){var e=Object(n.a)(["\n  query Quotes1($quote: GetQuotes) {\n    quotes(quote: $quote) {\n      ...QuoteFromTagFrag\n    }\n  }\n\n  ","\n"]);return c=function(){return e},e}var u=o()(c(),s.a);t.a=u},377:function(e,t,r){"use strict";t.a={flex:1,overflowX:"hidden",overflowY:"auto",padding:"0 5px"}},397:function(e,t,r){"use strict";var n=r(23),a=r(10),o=r.n(a),s=r(15),c=r(64),u=r(66),l=r(65),i=r(68),d=r(67),m=r(0),h=r.n(m),p=r(398),f=r(613),v=r(619),g=r(624),b=r(400),E=r(633),S=r(7),O=r(8),C=r.n(O);function y(){var e=Object(S.a)(["\n  fragment TextSearchRowFrag on QuoteFullSearchResultRow {\n    tid\n    text\n    source\n    column\n  }\n"]);return y=function(){return e},e}var x=C()(y());function j(){var e=Object(S.a)(["\n  fragment TextSearchResultFrag on QuoteFullSearchResult {\n    quotes {\n      ...TextSearchRowFrag\n    }\n\n    sources {\n      ...TextSearchRowFrag\n    }\n\n    tags {\n      ...TextSearchRowFrag\n    }\n\n    authors {\n      ...TextSearchRowFrag\n    }\n\n    sourceTypes {\n      ...TextSearchRowFrag\n    }\n  }\n\n  ","\n"]);return j=function(){return e},e}var k=C()(j(),x),T=k;function N(){var e=Object(S.a)(["\n  query AllMatchingTexts($text: QuoteFullSearchInput!) {\n    quoteFullSearch(text: $text) {\n      ...TextSearchResultFrag\n    }\n  }\n\n  ","\n"]);return N=function(){return e},e}var w=C()(N(),T),I=r(27),R=r(340),F=r.n(R),q=r(341),Q=r.n(q),P=r(37),$=r(377);F.a.setup(Q()());var U={root:P.c,input:{margin:"0 5px"},mainContent:Object(I.a)({},$.a,{margin:"5px 3px 0 0"}),resultContainer:{margin:"0",overflowY:"auto",wordBreak:"break-all"},result:{marginTop:"15px;","&.first-of-type":{marginTop:"0;"},"& .ui.list>a.item":{color:"initial"}},resultRowHeaderContainer:{textAlign:"center"},resultRowHeader:{display:"inline-block",minWidth:"40%",boxShadow:"0 1px 1px -1px black;"},resultRowItem:Object(I.a)({},{borderTop:["none","!important;"]},{borderBottom:"1px solid #22242626",marginTop:8})},D=F.a.createStyleSheet(U).attach().classes,B=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={hasError:!1},r}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?m.createElement(g.a,{error:!0,icon:!0,style:{marginTop:"20px"},className:this.props.className||""},m.createElement(b.a,{name:"ban"}),m.createElement(g.a.Content,null,m.createElement(g.a.Header,{style:{borderBottom:"1px solid",display:"inline-block",marginBottom:"10px"}},"An error has occurred"),m.createElement("div",null,JSON.stringify(this.state.info,null,2)))):this.props.children}}]),t}(m.Component),A=r(12),K={SOURCES:A.m,TAGS:A.n,QUOTES:A.l,AUTHORS:A.j},_={searchText:"",searchLoading:!1},G=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).state=_,r.doSearchDebounced=void 0,r.onSearchInputChange=function(e,t){var n=t.value,a=r.state.result;a=n?a:void 0,r.setState({searchText:n,searchError:void 0,result:a}),r.doSearchDebounced()},r.doSearch=Object(s.a)(o.a.mark(function e(){var t,n,a,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=r.state.searchText.trim()).length<2)){e.next=3;break}return e.abrupt("return");case 3:return r.setState({searchLoading:!0}),e.prev=4,e.next=7,r.props.client.query({query:w,variables:{text:{text:t}}});case 7:if(n=e.sent,a=n.data){e.next=11;break}return e.abrupt("return");case 11:s=a.quoteFullSearch,r.setState({searchLoading:!1,result:s}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),r.setState({searchLoading:!1,searchError:e.t0});case 18:case"end":return e.stop()}},e,null,[[4,15]])})),r.renderResult=function(e){var t=e.quotes,n=e.tags,a=e.authors,o=e.sources,s=e.sourceTypes;return a||t||o||s||n?h.a.createElement("div",{className:D.resultContainer},[t,n,a,o,s].map(r.renderCategory)):h.a.createElement(g.a,{className:D.resultContainer,style:{textAlign:"center",padding:"10px"},icon:!0,warning:!0,size:"small"},h.a.createElement(b.a,{name:"warning",size:"tiny",fitted:!0,style:{fontSize:"2em"}}),h.a.createElement(g.a.Content,null,"No Result!"))},r.renderCategory=function(e){if(e){var t=e[0];if(t){var n=t.source;return h.a.createElement("div",{className:D.result,key:n},h.a.createElement("div",{className:D.resultRowHeaderContainer},h.a.createElement("span",{className:D.resultRowHeader},n)),h.a.createElement(v.a,{divided:!0},e.map(r.renderRow(n))))}}},r.renderRow=function(e){return function(t){if(t){var r=t.text,n=t.tid,a=t.column,o=K[e],s=o?{as:E.a,to:o(n.toString())}:{};return h.a.createElement(v.a.Item,Object.assign({key:n+a,className:D.resultRowItem},s),h.a.createElement(v.a.Content,null,r))}}},r.doSearchDebounced=Object(p.a)(r.doSearch,700),r}return Object(d.a)(t,e),Object(i.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.searchComponentState;return r&&t===_?r:null}}]),Object(i.a)(t,[{key:"componentWillUnmount",value:function(){this.props.updateSCSLocal({variables:{searchComponentState:this.state}}),this.doSearchDebounced.cancel()}},{key:"render",value:function(){return h.a.createElement("div",{className:D.root},h.a.createElement("form",null,h.a.createElement(f.a,{className:D.input,icon:"search",placeholder:"Search...",fluid:!0,autoFocus:!0,onChange:this.onSearchInputChange,value:this.state.searchText,loading:this.state.searchLoading})),h.a.createElement(B,{className:D.mainContent},h.a.createElement("div",{className:D.mainContent},this.state.searchError&&h.a.createElement(g.a,{error:!0,icon:!0,style:{marginTop:"20px"}},h.a.createElement(b.a,{name:"ban"}),h.a.createElement(g.a.Content,null,h.a.createElement(g.a.Header,{style:{borderBottom:"1px solid",display:"inline-block",marginBottom:"10px"}},"An error has occurred"),h.a.createElement("div",null,JSON.stringify(this.state.searchError,null,2)))),!this.state.searchError&&this.state.searchText&&this.state.result&&this.renderResult(this.state.result))))}}]),t}(h.a.Component);function L(){var e=Object(S.a)(["\n  mutation SearchComponentStateLocalMutation(\n    $searchComponentState: SearchLocalInput!\n  ) {\n    searchComponentState(searchComponentState: $searchComponentState) @client\n  }\n"]);return L=function(){return e},e}var V=C()(L()),H=Object(n.e)(V,{props:function(e){return{updateSCSLocal:e.mutate}}});function M(){var e=Object(S.a)(["\n  query SearchComponentStateLocalQuery {\n    searchComponentState @client {\n      searchText\n      searchLoading\n      result {\n        ...TextSearchResultFrag\n      }\n      searchError\n    }\n  }\n\n  ","\n"]);return M=function(){return e},e}var z=C()(M(),k),W=Object(n.e)(z,{props:function(e){return e.data}});t.a=Object(n.d)(n.f,W,H)(G)},590:function(e,t,r){},591:function(e,t,r){},617:function(e,t,r){"use strict";r.r(t);var n=r(23),a=r(27),o=r(115),s=r(10),c=r.n(s),u=r(15),l=r(64),i=r(68),d=r(66),m=r(65),h=r(67),p=r(0),f=r.n(p),v=r(343),g=r(184),b=r.n(g),E=r(631),S=r(629),O=r(616),C=r(614),y=r(624),x=r(400),j=r(335),k=r(332),T=r(117),N=r.n(T),w=r(633),I=r(396),R=(r(590),r(342)),F=r(375),q=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,r=e.value,n=e.selectError;return p.createElement(F.a,{className:"".concat(n?"error":""),id:t,name:t,placeholder:"Select tags",options:this.props.tags,multi:!0,onChange:this.props.handleChange,onBlur:this.props.handleBlur,value:r,labelKey:"text",valueKey:"id"})}}]),t}(p.Component),Q=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,r=e.value,n=e.selectError,o=e.sources;return p.createElement(F.a,{className:"".concat(n?"error":""),id:t,name:t,placeholder:"Select source",options:o.map(function(e){return Object(a.a)({},e,{display:Object(R.b)(e)})}),onChange:this.props.handleChange,onBlur:this.props.handleBlur,value:r,labelKey:"display",valueKey:"id"})}}]),t}(p.Component),P=r(52),$=r(125),U=r(340),D=r.n(U),B=r(341),A=r.n(B),K=r(613);D.a.setup(A()());var _=D.a.createStyleSheet({date:{border:"1px solid #22242626",outline:0,padding:"0.3em",borderRadius:"0.2em",textAlign:"center"},dateDayInput:{flexGrow:[1,"!important"]},dateMonthInput:{flexGrow:[1,"!important"]},dateYearInput:{padding:["0px","!important"],flexGrow:[2,"!important"]}}).attach().classes,G=function(e){function t(e){var r;return Object(l.a)(this,t),(r=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={date:{},errors:{}},r.getError=function(e){var t=r.state.errors[e];return void 0!==t&&t},r.handleChange=function(e){return function(t){var n=r.props,o=n.onBlur,s=n.onChange;o&&o();var c=t.target,u=+c.min,l=+c.max,i=+c.value,d=i<u||i>l?null:i,m=r.state,h=m.date,p=m.errors;h=Object(a.a)({},h,Object(P.a)({},e,i)),p=Object(a.a)({},p,Object(P.a)({},e,!d)),r.setState(function(e){return Object(a.a)({},e,{date:h,errors:p})}),s&&s(Object(a.a)({},h,Object(P.a)({},e,d)))}},r.handleKeyPress=function(e){var t=e.currentTarget,r=t.value.length;(r>0&&r>t.maxLength-1||[".",","].includes(e.key))&&e.preventDefault()},["handleChange","handleKeyPress","getError"].forEach(function(e){return r[e]=r[e].bind(Object($.a)(r))}),r}return Object(h.a)(t,e),Object(i.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){return e.value?null:{date:{},errors:{}}}}]),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.date,t=e.day,r=e.month,n=e.year;return p.createElement(O.a.Group,{className:"".concat(_.date," ").concat(this.props.className||""),inline:!0},p.createElement(O.a.Field,{className:_.dateDayInput,control:K.a,type:"number",value:t||"",min:1,max:31,maxLength:2,label:"Day",placeholder:"Day",fluid:!0,onChange:this.handleChange("day"),onKeyPress:this.handleKeyPress,error:this.getError("day")}),p.createElement(O.a.Field,{className:_.dateMonthInput,control:K.a,type:"number",value:r||"",min:1,max:12,maxLength:2,label:"Month",placeholder:"Month",fluid:!0,onChange:this.handleChange("month"),onKeyPress:this.handleKeyPress,error:this.getError("month")}),p.createElement(O.a.Field,{className:_.dateYearInput,control:K.a,type:"number",value:n||"",min:1e3,max:9999,maxLength:4,label:"Year",placeholder:"Year",fluid:!0,onChange:this.handleChange("year"),onKeyPress:this.handleKeyPress,error:this.getError("year")}))}}]),t}(p.Component),L=r(12);D.a.setup(A()());var V=D.a.createStyleSheet({page:{border:"1px solid #22242626",outline:0,padding:"0.3em",borderRadius:"0.2em",textAlign:"center",justifyContent:"center"},startInput:{flexGrow:[1,"!important"]},endInput:{flexGrow:[1,"!important"]}}).attach().classes,H=function(e){function t(e){var r;return Object(l.a)(this,t),(r=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={page:{},errors:{}},r.getError=function(e){var t=r.state.errors[e];return void 0!==t&&t},r.handleChange=function(e){return function(t){var n=r.props,o=n.onBlur,s=n.onChange;o&&o();var c=+t.target.value,u=r.state,l=u.page,i=u.errors;l=Object(a.a)({},l,Object(P.a)({},e,c)),i="end"!==e||l.start?{start:!1,end:!1}:{start:i.start,end:!0},r.setState(function(e){return Object(a.a)({},e,{page:l,errors:i})}),s&&s(l)}},r.handleKeyPress=function(e){[".",","].includes(e.key)&&e.preventDefault()},["handleChange","handleKeyPress","getError"].forEach(function(e){return r[e]=r[e].bind(Object($.a)(r))}),r}return Object(h.a)(t,e),Object(i.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){return e.value?null:{page:{},errors:{}}}}]),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.page,t=e.start,r=e.end;return p.createElement(O.a.Group,{className:"".concat(V.page," ").concat(this.props.className||""),inline:!0},p.createElement(O.a.Field,{className:V.startInput,control:K.a,type:"number",value:t||"",label:"Page start",placeholder:"Page start",fluid:!0,onChange:this.handleChange("start"),onKeyPress:this.handleKeyPress,error:this.getError("start")}),p.createElement(O.a.Field,{className:V.endInput,control:K.a,type:"number",value:r||"",label:"Page end",placeholder:"Page end",fluid:!0,onChange:this.handleChange("end"),onKeyPress:this.handleKeyPress,error:this.getError("end")}))}}]),t}(p.Component);D.a.setup(A()());var M=D.a.createStyleSheet({volumeIssue:{border:"1px solid #22242626",outline:0,padding:"0.3em",borderRadius:"0.2em",textAlign:"center",justifyContent:"center"},volumeInput:{flexGrow:[1,"!important"]},issueInput:{flexGrow:[1,"!important"]}}).attach().classes,z=function(e){function t(e){var r;return Object(l.a)(this,t),(r=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={volumeIssue:{}},r.handleChange=function(e){return function(t){var n=r.props,o=n.onBlur,s=n.onChange;o&&o();var c=t.target,u=r.state.volumeIssue;u=Object(a.a)({},u,Object(P.a)({},e,c.value)),r.setState(function(e){return Object(a.a)({},e,{volumeIssue:u})}),s&&s(u)}},["handleChange"].forEach(function(e){return r[e]=r[e].bind(Object($.a)(r))}),r}return Object(h.a)(t,e),Object(i.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){return e.value?null:{volumeIssue:{}}}}]),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.volumeIssue,t=e.volume,r=e.issue;return p.createElement(O.a.Group,{className:"".concat(M.volumeIssue," ").concat(this.props.className||""),inline:!0},p.createElement(O.a.Field,{className:M.volumeInput,control:K.a,value:t||"",label:"Volume",placeholder:"Volume",fluid:!0,onChange:this.handleChange("volume")}),p.createElement(O.a.Field,{className:M.issueInput,control:K.a,value:r||"",label:"Issue",placeholder:"Issue",fluid:!0,onChange:this.handleChange("issue")}))}}]),t}(p.Component),W=r(7),Y=r(8),J=r.n(Y),X=r(72),Z=r(355);function ee(){var e=Object(W.a)(["\n  mutation CreateQuote($quote: CreateQuoteInput!) {\n    createQuote(quote: $quote) {\n      ...QuoteFromTagFrag\n\n      source {\n        ...SourceFullFrag\n      }\n    }\n  }\n\n  ","\n  ","\n"]);return ee=function(){return e},e}var te=J()(ee(),Z.a,X.b),re=r(123);function ne(){var e=Object(W.a)(["\n  query Source1($source: GetSourceInput!) {\n    source(source: $source) {\n      ...SourceFullFrag\n    }\n  }\n\n  ","\n"]);return ne=function(){return e},e}var ae=J()(ne(),X.b),oe=r(348),se=r(376),ce=r(618),ue=r(345);D.a.setup(A()());var le,ie={modal:{marginTop:"20px",maxHeight:"40%"},content:{color:ue.b,backgroundColor:ue.a},error:{flex:1,padding:20,textAlign:"center"},buttonContainer:{flexShrink:0,textAlign:"right",padding:"0 0 5px 0"}},de=ie.modal,me=ie.error,he=ie.buttonContainer,pe=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.createElement(ce.a,{style:de,dimmer:"inverted",open:this.props.open,onClose:this.props.dismiss},p.createElement(ce.a.Content,{style:ie.content},p.createElement("div",{style:me},this.props.error.message),p.createElement("div",{style:he},p.createElement(S.a,{color:"red",onClick:this.props.dismiss},p.createElement(x.a,{name:"remove"})," Dismiss"))))}}]),t}(p.Component),fe={tags:[],source:null,quote:"",date:null,page:null,volumeIssue:null,extras:""},ve={date:"",sourceId:"",tags:[],text:""};!function(e){e.RE_USE_SOURCE="re-use source",e.DO_NOT_RE_USE_SOURCE="do not re-use source"}(le||(le={})),D.a.setup(A()());var ge,be={modal:{marginTop:"20px",maxHeight:"40%",maxWidth:300},content:{background:ue.c,color:ue.d},messageContainer:{flex:1,display:"flex",padding:10,fontSize:"1.5em"},messageIcon:{paddingRight:"10px",fontSize:"1.5em"},messageHeader:{fontWeight:900,textAlign:"center"},messageAction:{fontSize:"0.8em",fontStyle:"italic"},buttonsContainer:{flexShrink:0,padding:"10px 8px 5px 10px",display:"flex",justifyContent:"space-between",borderTop:"1px solid #b3dcb4","&.single":{display:"block",textAlign:"right"}}},Ee=be.modal,Se=be.content,Oe=be.messageIcon,Ce=D.a.createStyleSheet(be).attach().classes,ye=function(e){function t(){var e,r;Object(l.a)(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(r=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).renderButtons=function(){return r.props.reUseSource?p.createElement("div",{className:"single ".concat(Ce.buttonsContainer)},p.createElement(S.a,{color:"red",inverted:!0,onClick:r.props.dismiss(le.DO_NOT_RE_USE_SOURCE)},p.createElement(x.a,{name:"remove"})," Dismiss")):p.createElement("div",{className:Ce.buttonsContainer},p.createElement(S.a,{color:"red",inverted:!0,onClick:r.props.dismiss(le.DO_NOT_RE_USE_SOURCE)},p.createElement(x.a,{name:"remove"})," Nope"),p.createElement(S.a,{color:"green",inverted:!0,onClick:r.props.dismiss(le.RE_USE_SOURCE)},p.createElement(x.a,{name:"checkmark"})," Ok"))},r}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.reUseSource;return p.createElement(ce.a,{style:Ee,dimmer:"inverted",open:this.props.open},p.createElement(ce.a.Content,{style:Se},p.createElement("div",{className:Ce.messageContainer},p.createElement(x.a,{style:Oe,name:"thumbs up"}),p.createElement("div",null,p.createElement("div",{className:Ce.messageHeader},"Quote successfully created"),!e&&p.createElement("div",{className:Ce.messageAction},"Create another quote for this source?"))),this.renderButtons()))}}]),t}(p.Component),xe=r(612),je=r(625),ke=r(619),Te=(r(591),r(122)),Ne=r(397),we=r(58);!function(e){e.QUOTES="quotes",e.TAGS="tags",e.SOURCES="sources"}(ge||(ge={}));var Ie=function(e){function t(){var e,r;Object(l.a)(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(r=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).state={},r.onTabChange=function(e,t){switch(t.activeIndex){case 0:r.fetchQuotes();break;case 1:r.fetchTags();break;case 2:r.fetchSources()}},r.renderError=function(e){var t=r.state.graphQlError;return e=(e=e.toLowerCase()).charAt(0).toUpperCase()+e.slice(1),f.a.createElement("div",{className:"message-container error"},f.a.createElement(x.a,{className:"message-icon",name:"warning sign"}),f.a.createElement("div",null,f.a.createElement("div",{className:"message-header"},"Error fetching: ".concat(e)),f.a.createElement("div",null,t&&t.message)))},r.renderQuotes=function(){return{menuItem:"Quotes",render:function(){return f.a.createElement(je.a.Pane,{className:"pane",attached:!1,loading:r.state.loading},r.renderResourcesOr(ge.QUOTES))}}},r.renderquote=function(e){var t=e.id,r=e.text;return f.a.createElement(ke.a.Item,{key:t},f.a.createElement(ke.a.Content,null,r))},r.renderTags=function(){return{menuItem:"Tags",render:function(){return f.a.createElement(je.a.Pane,{className:"pane",attached:!1,loading:r.state.loading},r.renderResourcesOr(ge.TAGS))}}},r.rendertag=function(e){var t=e.id,n=e.text;return f.a.createElement(ke.a.Item,{key:t,className:"list-item",onClick:r.navigateTo(Object(L.n)(t))},f.a.createElement(ke.a.Content,null,n))},r.renderSources=function(){return{menuItem:"Sources",render:function(){return f.a.createElement(je.a.Pane,{className:"pane",attached:!1,loading:r.state.loading},r.renderResourcesOr(ge.SOURCES))}}},r.rendersource=function(e){var t=e.id,n=Object(R.b)(e);return f.a.createElement(ke.a.Item,{key:t,className:"list-item",onClick:r.navigateTo(Object(L.m)(t))},f.a.createElement(ke.a.Content,null,n))},r.renderSearch=function(){return{menuItem:"Search",render:function(){return f.a.createElement(je.a.Pane,{className:"pane",attached:!1,loading:r.state.loading},f.a.createElement(Ne.a,null))}}},r.fetchQuotes=Object(u.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.fetching(),e.prev=1,e.next=4,r.props.client.query({query:se.a,variables:{quote:{source:null}}});case 4:t=e.sent,n=t.data.quotes,r.fetching(ge.QUOTES,n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),r.fetching(void 0,void 0,e.t0);case 12:case"end":return e.stop()}},e,null,[[1,9]])})),r.fetchTags=Object(u.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.fetching(),e.prev=1,e.next=4,r.props.client.query({query:Te.a});case 4:t=e.sent,n=t.data.tags,r.fetching(ge.TAGS,n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),r.fetching(void 0,void 0,e.t0);case 12:case"end":return e.stop()}},e,null,[[1,9]])})),r.fetchSources=Object(u.a)(c.a.mark(function e(){var t,n,a,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.props.currentProject){e.next=4;break}return r.setState({graphQlError:{message:"No project selected."}}),e.abrupt("return");case 4:return r.fetching(),e.prev=5,n=t.id,e.next=9,r.props.client.query({query:re.a,variables:{source:{projectId:n}}});case 9:a=e.sent,o=a.data.sources,r.fetching(ge.SOURCES,o),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),r.fetching(void 0,void 0,e.t0);case 17:case"end":return e.stop()}},e,null,[[5,14]])})),r.fetching=function(e,t,n){r.setState({graphQlError:void 0}),n?r.setState({loading:!1,graphQlError:n}):e&&t?r.setState(function(r){var n;return N()(r,(n={loading:{$set:!1}},Object(P.a)(n,e,{$set:t}),Object(P.a)(n,"graphQlError",{$set:void 0}),n))}):r.setState({loading:!0})},r.navigateTo=function(e){return function(){r.props.history.push(e)}},r}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return f.a.createElement(je.a,{className:"src-components-new-quote-sidebar ".concat(this.props.className||""),menu:{pointing:!0,inverted:!0,secondary:!0},panes:[this.renderQuotes(),this.renderTags(),this.renderSources(),this.renderSearch()],onTabChange:this.onTabChange,defaultActiveIndex:-1})}},{key:"renderResourcesOr",value:function(e){var t=this.state,r=t.loading;if(t.graphQlError)return this.renderError(e);var n=this.state[e];return r&&!n?f.a.createElement(we.a,null):n&&n.length?f.a.createElement(ke.a,{divided:!0,relaxed:!0,ordered:!0},n.map(this["render"+e.slice(0,-1)])):f.a.createElement("div",null,"No ".concat(e,"!"))}}]),t}(f.a.Component),Re=r(118),Fe=Object(n.e)(Re.a,{props:function(e){return e.data}}),qe=Object(n.d)(Fe,xe.a,n.f)(Ie),Qe=r(354),Pe=function(e){function t(){var e,r;Object(l.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(r=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s)))).state={initialFormValues:fe,formOutputs:ve,selectedTags:[]},r.formContainerRef=p.createRef(),r.renderErrorOrSuccess=function(){var e=r.state,t=e.sourceId,n=e.graphqlError,a=e.submittedSourceId;return n?p.createElement(pe,{open:!!n,dismiss:r.dismissErrorModal,error:n}):a?p.createElement(ye,{open:!!a,dismiss:r.onSuccessModalDismissed,reUseSource:!!t}):void 0},r.renderSourceQuoteHeader=function(){var e=r.state.initialFormValues.source;return p.createElement(E.a,{dividing:!0,className:"quote-source-display-container"},e&&p.createElement(w.a,{className:"quote-link",to:Object(L.m)(e.id)},p.createElement("div",{className:"quote-source-label"},"Click to go to source"),p.createElement("div",{className:"quote-source-display"},Object(R.b)(e))))},r.validate=function(e){for(var t={},n=Object.keys(e),a=0;a<n.length;a++){var o=n[a],s=r["validate".concat(o.charAt(0).toUpperCase()).concat(o.slice(1))](e[o]);if(s)return t[o]=s,t}return t},r.renderForm=function(e){var t=e.handleReset,n=e.dirty,a=e.isSubmitting,o=e.errors,s=e.handleSubmit,c=!n||a,u=c||!b()(o),l=r.state.sourceId;return p.createElement(O.a,{onSubmit:s},p.createElement(j.a,{inverted:!0,active:a},p.createElement(k.a,{active:a,size:"medium"},"Saving..")),p.createElement(v.a,{name:"tags",render:r.renderTagControl}),!l&&p.createElement(v.a,{name:"source",render:r.renderSourceControl}),p.createElement(v.a,{name:"quote",render:r.renderQuoteControl}),p.createElement(v.a,{name:"page",render:r.renderPageControl}),p.createElement(v.a,{name:"volumeIssue",render:r.renderVolumeIssueControl}),p.createElement(v.a,{name:"date",render:r.renderDateControl}),p.createElement(v.a,{name:"extras",render:r.renderExtrasControl}),p.createElement("div",{className:"submit-reset"},p.createElement(S.a,{basic:!0,color:"red",onClick:r.onResetClicked(t),disabled:c},p.createElement(x.a,{name:"remove"})," Reset"),p.createElement(S.a,{className:"submit-button",type:"submit",color:"green",disabled:u,loading:a},p.createElement(x.a,{name:"checkmark"})," Ok")))},r.submit=function(e){return function(){var t=Object(u.a)(c.a.mark(function t(n,a){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.setSubmitting(!0),t.prev=1,t.next=4,e();case 4:a.resetForm(),r.setState(function(e){return N()(e,{submittedSourceId:{$set:n.source&&n.source.id},initialFormValues:{tags:{$set:[]}}})}),r.scrollToTopOfForm(),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),a.setSubmitting(!1),r.setState({graphqlError:t.t0});case 13:case"end":return t.stop()}},t,null,[[1,9]])}));return function(e,r){return t.apply(this,arguments)}}()},r.onTagCreated=function(e){r.setState(function(t){return N()(t,{initialFormValues:{tags:{$set:[].concat(Object(o.a)(r.state.selectedTags),[e])}}})})},r.renderTagControl=function(e){var t=e.field,n=t.name,a=t.value,o=e.form,s=o.errors[n],c=!!s,u=o.touched[n],l=r.props.tags;return p.createElement("div",{className:"tags-field"},p.createElement(O.a.Field,{control:q,label:"Select at least one tag",error:c,selectError:c,tags:l||[],name:n,value:a,handleChange:r.onTagSelected(e),handleBlur:r.handleFormControlBlur(n,o)},c&&u&&p.createElement(y.a,{error:!0,header:s})))},r.onTagSelected=function(e){var t=e.form,n=e.field;return function(e){t.setFieldValue(n.name,e),r.setState(function(t){return N()(t,{selectedTags:{$set:e}})})}},r.handleFormControlBlur=function(e,t){return function(){t.setFieldTouched(e,!0)}},r.handleControlChange=function(e,t){return function(r){return t.setFieldValue(e,r)}},r.renderQuoteControl=function(e){var t=e.field,r=e.form,n=t.name,a=!!r.errors[n];return p.createElement(O.a.Field,Object.assign({control:C.a,placeholder:"Quote text",label:"Quote text",id:n,error:a},t))},r.renderExtrasControl=function(e){var t=e.field,r=e.form,n=t.name,a=!!r.errors[n];return p.createElement(O.a.Field,Object.assign({control:C.a,placeholder:"Extras",label:"Extras",id:n,error:a},t))},r.renderDateControl=function(e){var t=e.field,n=e.form,a=t.name,o=!!n.errors[a];return p.createElement(G,{className:"".concat(o?"error-border":""),onChange:r.handleControlChange(a,n),onBlur:r.handleFormControlBlur(a,n),value:t.value})},r.renderPageControl=function(e){var t=e.field,n=e.form,a=t.name,o=!!n.errors[a];return p.createElement(H,{className:"".concat(o?"error-border":""),onChange:r.handleControlChange(a,n),onBlur:r.handleFormControlBlur(a,n),value:t.value})},r.renderVolumeIssueControl=function(e){var t=e.field,n=e.form,a=t.name,o=!!n.errors[a];return p.createElement(z,{className:"".concat(o?"error-border":""),onChange:r.handleControlChange(a,n),onBlur:r.handleFormControlBlur(a,n),value:t.value})},r.renderSourceControl=function(e){var t=e.field,n=t.name,a=t.value,o=e.form,s=o.errors[n],c=!!s,u=o.touched[n];return p.createElement(O.a.Field,{control:Q,label:"Select source",error:c,selectError:c,sources:r.getSources(),name:n,value:a,handleBlur:r.handleFormControlBlur(n,o),handleChange:r.handleControlChange(n,o)},c&&u&&p.createElement(y.a,{error:!0,header:s}))},r.getSources=function(){var e=r.state.queryResult;if(!e)return[];var t=e.data;return t?t.source?[t.source]:t.sources:[]},r.validateQuote=function(e){return e?(r.setState(function(t){return N()(t,{formOutputs:{text:{$set:e}}})}),""):"Enter a quote"},r.validateExtras=function(e){return e?(r.setState(function(t){return N()(t,{formOutputs:{extras:{$set:e}}})}),""):""},r.validateSource=function(e){return e?(r.setState(function(t){return N()(t,{formOutputs:{sourceId:{$set:e.id}}})}),""):"Select a source"},r.validateTags=function(e){return e&&e.length?(r.setState(function(t){return N()(t,{formOutputs:{tags:{$set:e.map(function(e){return e.id})}}})}),""):"Select at least one tag"},r.validateDate=function(e){var t="Enter a valid date";if(!e)return r.setState(function(e){return N()(e,{formOutputs:{date:{$set:void 0}}})}),"";if(3!==Object.keys(e).length)return t;var n=e.year,a=e.month,o=e.day;if(!(n&&a&&o))return t;var s="".concat(o).padStart(2,"0"),c="".concat(n,"-").concat(a,"-").concat(s),u=Object(I.a)(c);return r.setState(function(e){return N()(e,{formOutputs:{date:{$set:u?c:void 0}}})}),u?"":t},r.validatePage=function(e){if(!e)return"";var t=e.start,n=e.end;return r.setState(function(e){return N()(e,{formOutputs:{pageStart:{$set:t},pageEnd:{$set:n}}})}),""},r.validateVolumeIssue=function(e){if(!e)return"";var t=e.volume,n=e.issue;return r.setState(function(e){return N()(e,{formOutputs:{volume:{$set:t},issue:{$set:n}}})}),""},r.scrollToTopOfForm=function(){r.formContainerRef.current&&(r.formContainerRef.current.scrollTop=0)},r.onResetClicked=function(e){return function(){e(),r.scrollToTopOfForm()}},r.dismissErrorModal=function(){r.setState(function(e){return N()(e,{graphqlError:{$set:void 0}})})},r.onSuccessModalDismissed=function(e){return function(){var t=r.state,n=t.sourceId,a=t.submittedSourceId;r.setState({submittedSourceId:void 0}),!n&&a&&e===le.RE_USE_SOURCE&&r.props.history.push(Object(L.k)(a))}},r.fetchSource=Object(u.a)(c.a.mark(function e(){var t,n,a,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!r.state.sourceId){e.next=7;break}return e.next=4,r.props.client.query({query:ae,variables:{source:{id:r.state.sourceId}}});case 4:t=e.sent,e.next=13;break;case 7:if(n=r.props.currentProject){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,r.props.client.query({query:re.a,variables:{source:{projectId:n?n.id:"0"}}});case 12:t=e.sent;case 13:if(t){e.next=15;break}return e.abrupt("return");case 15:a=t,r.setState(function(e){return N()(e,{queryResult:{$set:a},initialFormValues:{source:{$set:a.data.source}}})}),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(0),o={data:{sources:[]}},r.setState({graphqlError:e.t0,queryResult:o});case 23:case"end":return e.stop()}},e,null,[[0,19]])})),r.writeQuoteToCache=function(){var e=Object(u.a)(c.a.mark(function e(t,n){var s,u,l,i,d,m,h,p;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((s=n.data)&&s.createQuote){e.next=3;break}return e.abrupt("return");case 3:u=s.createQuote,l=r.state.formOutputs.sourceId,i={query:se.a,variables:{quote:{source:l}}},e.prev=6,d=t.readQuery(i),m=d.quotes||[],t.writeQuery(Object(a.a)({},i,{data:{quotes:[u].concat(Object(o.a)(m))}})),e.next=19;break;case 12:if(e.prev=12,e.t0=e.catch(6),h=e.t0.message,p='Can\'t find field quotes({"quote":{"source":"'.concat(l,'"}})'),!h.startsWith(p)){e.next=18;break}return e.abrupt("return");case 18:throw e.t0;case 19:case"end":return e.stop()}},e,null,[[6,12]])}));return function(t,r){return e.apply(this,arguments)}}(),r}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.fetchSource(),Object(L.o)("New quote")}},{key:"componentDidUpdate",value:function(){this.state.queryResult||this.fetchSource()}},{key:"componentWillUnmount",value:function(){Object(L.o)()}},{key:"render",value:function(){var e=this;return p.createElement(Qe.a,{onTagCreated:this.onTagCreated},p.createElement("div",{className:"src-routes-new-quote"},p.createElement(oe.a,{className:"route-header",style:{margin:0},title:"New Quote",showSideBarTrigger:!0}),p.createElement("div",{className:"route-inner"},p.createElement("div",{className:"form-with-header"},this.state.sourceId&&this.renderSourceQuoteHeader(),p.createElement("div",{className:"main-content",ref:this.formContainerRef},this.renderErrorOrSuccess(),p.createElement(n.b,{mutation:te,variables:{quote:this.state.formOutputs},update:this.writeQuoteToCache},function(t){return p.createElement(v.b,{initialValues:e.state.initialFormValues,enableReinitialize:!0,onSubmit:e.submit(t),render:e.renderForm,validate:e.validate})}))),p.createElement(qe,{className:"quotes-sidebar"}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.match.params.sourceId;return r!==t.sourceId?N()(t,{sourceId:{$set:r},queryResult:{$set:void 0}}):null}}]),t}(p.Component),$e=Object(n.e)(Te.a,{props:function(e){return e.data}}),Ue=Object(n.e)(Re.a,{props:function(e){return e.data}});t.default=Object(n.d)(n.f,$e,Ue)(Pe)}}]);
//# sourceMappingURL=6.971b52bc.chunk.js.map